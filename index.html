<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Energy Tracker</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="stylesheet.css">
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
        <script src="https://unpkg.com/vue-cookies@1.7.4/vue-cookies.js"></script>
    </head>
    <body>
        <div id="app">
            <div class="centered">
                <div id="energyText">
                    <p>ENERGY</p>
                    <p id="energyCount"> {{ energy }} </p>
                </div>
                <button @click="energy += 1; updateCookies()">Add 1 Energy</button>
                <button @click="addCard(rnd())">Add Card</button>
                <button @click="removeEnergy()">Remove 1 Energy</button>
                <button class="rollButton" @click="rollDie()">Roll Die</button>
                <button class="resetEnergy" @click="energy = 3; updateCookies()">Reset Energy</button>
                <div id="rollHistory">
                    <p>
                        {{ results.join(', ') }}
                    </p>
                    <button class="clearHistory" @click="results = []; updateCookies()">Clear Roll History</button>
                </div>
                <div class="cardDiv">
                    <div class="card" v-for="(name, index) in cards">
                        <a href="javascript:void(0);" @click="deleteCard(index)">
                            <img :src="'./cards/' + name + '.jpg'" class="cardImage" alt="card">
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <script>
            new Vue({
                el: '#app',
                data: {
                    energy: 3,
                    results: [],
                    cards: []
                },
                beforeMount() {
                    if ($cookies.get('energy')) {
                        this.energy = parseInt($cookies.get('energy'))
                    }
                    if ($cookies.get('results')) {
                        this.results = ($cookies.get('results')).split(',')
                    }
                    if ($cookies.get('cards')) {
                        this.cards = ($cookies.get('cards')).split(',')
                    }
                },
                methods: {
                    addCard(name) {
                        this.cards.push(name)
                        this.updateCookies()
                    },
                    rnd() {
                        let num = Math.floor(Math.random() * 100)
                        if (num <= 50) return 'common/' + this.selectImage(num).toString()
                        else if (num <= 80) return 'uncommon/' + this.selectImage(num).toString()
                        else if (num <= 95) return 'rare/' + this.selectImage(num).toString()
                        else return 'epic/'+ this.selectImage(num).toString()
                    },
                    selectImage(num){
                        //add or remove cards here
                        let commonCards = ['oddish','fake_oddish']
                        let uncommonCards = ['gigalith','fake_gigalith']
                        let rareCards = ['zapdos','fake_zapdos']
                        let epicCards = ['kyogre','fake_kyogre']
                        if(num <= 50){
                            let commonCardnum = Math.floor(Math.random() * commonCards.length)
                            return commonCards[commonCardnum]
                            
                        }
                        else if(num <= 80){
                            let uncommonCardnum = Math.floor(Math.random() * commonCards.length)
                            return uncommonCards[uncommonCardnum]
                            
                        }
                        else if(num <= 95){
                            let rareCardNum = Math.floor(Math.random() * commonCards.length)
                            return rareCards[rareCardNum]
                        }
                        else{
                            let epicNum = Math.floor(Math.random() * commonCards.length)
                            return epicCards[epicNum]
                        }
                    },
                    deleteCard(i, cardCost) {
                        this.cards.splice(i,1)
                        this.updateCookies()
                    },
                    fn(a) {console.log(a)},
                    removeEnergy() {
                        if (this.energy > 0) {
                            this.energy -= 1
                        }
                        this.updateCookies()
                    },
                    rollDie() {
                        let rolled = Math.floor(Math.random() * 6) + 1
                        this.energy += rolled
                        this.results = this.results.concat(rolled)
                        this.updateCookies()

                    },
                    updateCookies() {
                        $cookies.set('energy', this.energy)
                        $cookies.set('results', this.results)
                        $cookies.set('cards', this.cards)
                    }
                }
            })
        </script>
    </body>
</html>
